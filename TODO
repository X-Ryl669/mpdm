Minimum Profit Data Manager (mpdm) TODO / Bug List
==================================================

Release Critical Bugs
---------------------

 * 1056: Fill the overview document.

Open Bugs
---------

 * 1061: On IRIX, iconv() doesn't have the "WCHAR_T" charset, so
   iconv support doesn't seem to work there; but it has "UCS-4", which
   is practically the same and it works, so there should be some
   workaround to use it whenever "WCHAR_T" fails.
 * 1065: There should exist some way to detect lack of gettext support
   in runtime to add implementation-specific workarounds as, for
   example, filling the i18n cache manually. This is something like
   a reopening of bug #1018.

Pending Enhancements
--------------------

 * 1006: stat().
 * 1007: chmod().
 * 1008: bread().
 * 1009: bwrite().
 * 1063: Implement copy-on-write on array cloning.
 * 1066: Implement a minimum time-to-live for values; never referenced values
   younger than that will never be swept. Values under explicit [un]ref()
   control won't have this, as they (should) never be used after being
   unreferenced, so TTL will be unset after being unreferenced to 0. Anyway,
   as this could mask possible sweeping errors, it has not been implemented yet.

Closed
------

 * 1000: All string operations should use wchar_t instead of char
   (Closed by: #1001; Sat, 3 Jul 2004 11:14:00 +0200).
 * 1001: Merge mpdm-branch-wchar
   (Closes: #1000; Sun, 4 Jul 2004 11:06:00 +0200).
 * 1002: mpdm_aget() and mpdm_aset() should accept negative offsets
   (Mon, 12 Jul 2004 17:44:00 +0200).
 * 1012: mpdm_startup() and mpdm_shutdown() (Thu, 26 Aug 2004 20:10:02 +0200)
 * 1013: Move the hardwired '16' number of minimum elements to an
   struct _mpdm element, set from mpdm_startup()
   (Thu, 26 Aug 2004 20:10:18 +0200).
 * 1014: Create a new high threshold for values, to force calling
   mpdm_sweep() from mpdm_new() if that threshold is overpassed (this
   will allow a limit to be imposed to the number of unreferenced
   values) (Thu, 26 Aug 2004 20:26:21 +0200).
 * 1019: Rework mpdm_dump() to avoid using dynamic values
   (Wed, 08 Sep 2004 21:52:39 +0200).
 * 1020: Set errno on errors (Discarded; Thu, 07 Oct 2004 17:11:52 +0200).
 * 1003: Beyond ties; suppress all flags (except some internal ones as IVAL
   or EXEC). Everything should be done with ties; for example, there
   should exist a _CMP tie function that would be executed when two
   values being compared have the same tie (or, better, the same _CMP
   function). Specially, MPDM_STRING and MPDM_MULTIPLE should disappear.
   A value will be assumed multiple when having a tie function _AEXPAND
   (or _AGET, or so). Code will become incidentally clean (no more "if
   flags & MPDM_" scattered through the code). Risky change!
   (Discarded; Wed, 08 Dec 2004 09:48:27 +0100).
 * 1005: Should ties be in a special source file, mpdm_t.c ?
   (Discarded; Wed, 08 Dec 2004 09:49:06 +0100).
 * 1011: Will the scripting language be included here, or as a
   separated package? it could poison the mpdm concept as a 'low
   level utility library' (Yes; Wed, 08 Dec 2004 09:51:55 +0100).
 * 1010: Find a name for the scripting language (Mpsl should be
   fine; Wed, 08 Dec 2004 09:52:32 +0100).
 * 1026: Make the _mpdm control structure public
   (Wed, 08 Dec 2004 11:34:54 +0100).
 * 1025: Change non-dyn values. They should be stored in a pool of
   values, and 'allocated' from within mpdm_new(). Two macros, for
   instance MPDM_ND_BEGIN() and MPDM_ND_END(), could save
   / restore a static index to that pool. Instead, the allocation
   from the pool would just wrap (Wed, 08 Dec 2004 16:52:21 +0100).
 * 1030: non-dyn array values are completely broken; the creation
   should include the array of values and not take it from mpdm_alloc().
   (Wed, 08 Dec 2004 19:16:05 +0100).
 * 1031: Size in MPDM_ND_A() is superfluous, as it can be calculated
   (Wed, 08 Dec 2004 22:12:57 +0100).
 * 1033: Create a new mpdm_hexists() function
   (Thu, 09 Dec 2004 11:19:03 +0100).
 * 1037: Add caching support in values for real numbers (like ival).
   (Sun, 12 Dec 2004 17:54:34 +0100).
 * 1043: Change mpdm_write() so that it doesn't use printf(), but
   wcstombs() and an small local buffer (Mon, 20 Dec 2004 08:41:20 -0800).
 * 1045: mpdm_dump() should not use printf() for mpdm_string(), but
   convert by hand using wcstombs() (Mon, 20 Dec 2004 08:44:52 -0800).
 * 1044: mpdm_write() should include a 3rd argument, a separator
   for the end of line (Mon, 20 Dec 2004 08:54:39 -0800).
 * 1048: mpdm_rval() breaks locales (Wed, 05 Jan 2005 16:05:52 +0100).
 * 1047: Change _mpdm_sym() to force the creation of all intermediate
   arrays or hashes in the way. Also, it does not make much sense to
   be in plain mpdm; it should be part of mpsl (Discarded;
   Sat, 08 Jan 2005 21:30:55 +0100).
 * 1016: Add optional iconv support
   (Closed by #1055; Thu, 10 Mar 2005 13:26:54 +0100).
 * 1054: Add a main() function, similar to the filp one
   (Not applicable; Fri, 18 Mar 2005 06:46:06 +0100).
 * 1032: Nondyn arrays must be protected in mpdm_aexpand(),
   mpdm_acollapse(), etc (Fri, 18 Mar 2005 08:00:28 +0100).
 * 1004: Create a tie function for mpdm_dump()
   (No; Fri, 18 Mar 2005 08:04:19 +0100).
 * 1057: Iconv objects can't be reused for different files, so
   current implementation is faulty. Each iconv_t variable should
   be stored inside the file value (Fri, 25 Mar 2005 02:24:10 +0100).
 * 1055: Iconv support works, but is nearly useless; iconverters
   should be associated to file descriptors, which are the only
   place where iconv will really be used (Fri, 25 Mar 2005 03:04:26 +0100).
 * 1058: Changeset on "2005-03-25 02:26 CET" (file descriptors in their's
   own structure) broke mpsl (SIGSEGV's on compiling from file). Last
   working version was "cvs update -D '2005/03/25 02:26'"
   (Bug is in mpsl; Fri, 25 Mar 2005 12:17:21 +0100).
 * 1015: The auto-sweep introduced by _mpdm.high_threshold is
   extremely unsafe. At least, internal parts of mpdm should be
   autosweep-safe (high_threshold abandoned; Mon, 28 Mar 2005 16:40:38 +0200).
 * 1059: Get rid of ties. They are flexible and sexy, but add a complexity
   that isn't worth (Sun, 03 Apr 2005 16:38:44 +0200).
 * 1018: Support for optional features (like gdbm) should be stored
   in an mpdm array or hash to easily ask for capabilities (gdbm support
   dropped, and no other optional features; Sun, 03 Apr 2005 16:39:19 +0200).
 * 1027: Store all static _tie... values in ties in the main
   control structure (ties no longer exist; Sun, 03 Apr 2005 16:40:12 +0200).
 * 1029: Store the regex cache in the main control structure
   (Sun, 03 Apr 2005 16:40:32 +0200).
 * 1028: With the closing of bugs #1026, #1027 and #1029, it should be
   easy to have multiple mpdm engines, just by commuting the _mpdm
   pointer. So, there should exist an mpdm_cleanup() function,
   that would, after destroying values by calling mpdm_shutdown(),
   free the rest of values stored inside. This kind of cleanup should
   not be necessary on normal shutdown, as memory will be freed by
   the operating system anyway (Doesn't seem necessary nor useful;
   Mon, 04 Apr 2005 18:51:48 +0200).
 * 1062: sprintf() (Not applicable, it should be implemented on mpsl instead;
   Mon, 11 Apr 2005 17:52:38 +0200).
 * 1060: Some old Unix systems (for example, IRIX) and mingw32
   don't have the mbrtowc() function (they do have mbtowc(), though)
   (Tue, 12 Apr 2005 18:55:42 +0200).
 * 1017: Add optional gettext support (Sat, 16 Apr 2005 11:05:31 +0200).
 * 1064: There should exist some way to detect the lack of gettext
   support and set a translation hash (Closed by #1065;
   Sat, 16 Apr 2005 11:32:11 +0200).
 * 1071: The _cache_18n hash in mpdm_s.c has be moved to the main control
   structure (Thu, 26 May 2005 14:01:17 +0200).
 * 1072: mpdm_v should be renamed to mpdm_t (Thu, 26 May 2005 17:34:27 +0200).
 * 1067: Get rid of symbols prefixed with _ (Thu, 26 May 2005 17:59:17 +0200).
 * 1068: Rewrite the circular list of values as a double-list (i.e., with
   links to previous) (Thu, 26 May 2005 18:48:56 +0200).
 * 1069: The mpdm_free() function should dequeue the value about to be
   destroyed; this way, it could be called from other functions, like
   mpdm_unref() (Thu, 26 May 2005 18:48:56 +0200).
 * 1070: Modify mpdm_unref() to optionally destroy a value when its
   reference count gets to 0 (needs #1068 and #1069 closed) (No. This is not
   that a good idea, as there are many places where values are referenced to
   zero and later used, as in mpdm_asort(), or where semantics change, for
   example, when mpdm_aset() returns the previous value;
   Thu, 26 May 2005 20:28:33 +0200).

Email bugs to angel@triptico.com
